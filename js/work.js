
const detailData = [
  {
    title: "88 Marketplace",
    address: "2105 S Jefferson St Floor 2, Chicago, IL 60616",
    phone: "(312)929-4926",
    hours: "8 AM-9PM",
    reviews: "4.4",
    preference: "Vegan",
    allergyFriendly: "Nuts, Wheat",
    menu: "https://88marketplace.com/product",
    website: "https://88marketplace.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d5943.409598768618!2d-87.63851529569396!3d41.85618036175108!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880e2d9b68bb5335%3A0x85265e622596c593!2s88%20Marketplace!5e0!3m2!1sen!2sus!4v1713579276117!5m2!1sen!2sus",
    src1: "./restuarant_pics/RPM Italian.jpg",
    src2: "./restuarant_pics/RPM Italian.jpg"
  },
  {
    title: "Piccolo Sogno",
    address: "464 N Halsted St, Chicago, IL 60642",
    phone: "(312)-421-0077",
    hours: "11 AM - 9:30PM",
    reviews: "4.5",
    preference: "Vegan",
    allergyFriendly: "Peanut, Milk, Egg, Gluten Free",
    menu: "https://www.piccolosognorestaurant.com/s/DINNER-Spring-2024.pdf",
    website: "https://www.piccolosognorestaurant.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d23759.567190565216!2d-87.65385309616316!3d41.89402058262674!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880e2ccdfb4518b3%3A0x9e450ee590cdbc2c!2sPiccolo%20Sogno!5e0!3m2!1sen!2sus!4v1713583151292!5m2!1sen!2sus",
    src1: "./restuarant_pics/Piccolo Sogno.jpg",
    src2: "./restuarant_pics/Piccolo Sogno.jpg"
  },
  {
    title: "Little Goat Diner",
    address: "3325 N Southport Ave, Chicago, IL 60657",
    phone: "(773)-819-7673",
    hours: "8 AM - 8PM",
    reviews: "4.6",
    preference: "Vegan",
    allergyFriendly: "Peanut, Gluten Free, Egg, Milk",
    menu: "http://places.singleplatform.com/little-goat-bread/menu#menu_5648314",
    website: "https://littlegoatchicago.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d23752.406664463007!2d-87.67634752184692!3d41.91326594519617!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880e2cdab5b63bfb%3A0xddee29d79059dec7!2sLittle%20Goat%20Diner!5e0!3m2!1sen!2sus!4v1713583815987!5m2!1sen!2sus",
    src1: "./restuarant_pics/Little Goat Diner.png",
    src2: "./restuarant_pics/Little Goat Diner.png"
  },
  {
    title: "Big Star",
    address: "1531 N Damen Ave, Chicago, IL 60622",
    phone: "(773)-235-4039",
    hours: "11 AM - 11 PM",
    reviews: "4.4",
    preference: "Organic food",
    allergyFriendly: "Gluten Free, Peanut, Milk",
    menu: "https://www.bigstarchicago.com/location/wicker-park/",
    website: "http://www.bigstarchicago.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d23752.384265538687!2d-87.67634752728632!3d41.913326135536956!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880fd2c76fc30bc3%3A0x50a58e733b2a9e6f!2sBig%20Star!5e0!3m2!1sen!2sus!4v1713584099531!5m2!1sen!2sus",
    src1: "./restuarant_pics/Big Star.jpg",
    src2: "./restuarant_pics/Big Star.jpg"
  },
  {
    title: "Parlor Pizza Bar",
    address: "1824 W Division St, Chicago, IL 60622",
    phone: "(872)-315-3005",
    hours: "5 AM - 11 PM",
    reviews: "4.4",
    preference: "Vegan",
    allergyFriendly: "Gluten Free",
    menu: "https://parlorchicago.com/menu/",
    website: "https://parlorchicago.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d5938.804263321396!2d-87.67493132642441!3d41.90571331544946!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880fd2c9283f3a91%3A0xac3b56028d1917e5!2sParlor%20Pizza%20Bar%20Wicker%20Park!5e0!3m2!1sen!2sus!4v1713584431022!5m2!1sen!2sus",
    src1: "./restuarant_pics/Parlor-Pizza-Bar.jpg",
    src2: "./restuarant_pics/Parlor-Pizza-Bar.jpg"
  },
  {
    title: "The Chicago Diner",
    address: "2333 N Milwaukee Ave, Chicago, IL 60647",
    phone: "(773)-252-3211",
    hours: "11 AM - 9 PM",
    reviews: "4.6",
    preference: "Organic food",
    allergyFriendly: "Peanut, Wheat",
    menu: "https://veggiediner.com/menus/",
    website: "https://veggiediner.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d47497.04768799121!2d-87.73966223046872!3d41.92369879999999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880fcd6263e0b471%3A0xdfb32b385eaac5b0!2sThe%20Chicago%20Diner%2C%20Logan%20Square!5e0!3m2!1sen!2sus!4v1713585071582!5m2!1sen!2sus",
    src1: "./restuarant_pics/The Chicago Diner.jpg",
    src2: "./restuarant_pics/The Chicago Diner.jpg"
  },
  {
    title: "Quartino Ristorante",
    address: "626 N State St, Chicago, IL 60654",
    phone: "(312)-698-5000",
    hours: "11:30 AM - 12:30 PM",
    reviews: "4.6",
    preference: "Vegan",
    allergyFriendly: "Shellfish, Nuts",
    menu: "https://quartinoristorante.com/chicago/menus",
    website: "https://quartinoristorante.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d47517.367492114805!2d-87.67886464410397!3d41.89639540810733!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880e2cad6324f2a9%3A0x90289d25b5a8fd30!2sQuartino%20Ristorante!5e0!3m2!1sen!2sus!4v1713585327922!5m2!1sen!2sus",
    src1: "./restuarant_pics/Quartino-Ristorante.jpg",
    src2: "./restuarant_pics/Quartino-Ristorante.jpg"
  },
  {
    title: "Defloured: A Gluten Free Bakery",
    address: "1477 W Balmoral Ave, Chicago, IL 60640",
    phone: "(773)-234-5733",
    hours: "11 AM - 7 PM",
    reviews: "4.8",
    preference: "Vegan",
    allergyFriendly: "Peanut, Milk, Egg",
    menu: "https://deflouredbakery.com/goodies",
    website: "https://deflouredbakery.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2965.9584822562742!2d-87.67041522310122!3d41.97970115904556!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880fd1f92ca9eb45%3A0x6dd4e692ef22c4e0!2sdefloured%3A%20A%20Gluten%20Free%20Bakery!5e0!3m2!1sen!2sus!4v1713585527445!5m2!1sen!2sus",
    src1: "./restuarant_pics/Defloured A Gluten Free Bakery.jpg",
    src2: "./restuarant_pics/Defloured A Gluten Free Bakery.jpg"
  },
  {
    title: "Sprinkles Chicago",
    address: "50 E Walton St, Chicago, IL 60611",
    phone: "(312)-573-1600",
    hours: "10 AM - 8 PM",
    reviews: "4.2",
    preference: "Vegetable oil",
    allergyFriendly: "Peanut, Milk, Egg",
    menu: "https://sprinkles.com/collections/cupcakes",
    website: "https://sprinkles.com/pages/location-chicago",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d189820.58504677293!2d-87.8326451895507!3d41.979955381096794!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880fd3518748b42f%3A0xeb69cf6c93401870!2sSprinkles%20Chicago!5e0!3m2!1sen!2sus!4v1713585793537!5m2!1sen!2sus",
    src1: "./restuarant_pics/Sprinkles Chicago.png",
    src2: "./restuarant_pics/Sprinkles Chicago.png"
  },
  {
    title: "Medici",
    address: "1327-1331, 1327 E 57th St, Chicago, IL 60637",
    phone: "(773)-667-7394",
    hours: "8 AM - 8 PM",
    reviews: "4.4",
    preference: "Vegetable oil",
    allergyFriendly: "Milk, Egg, Shellfish",
    menu: "https://www.medici57.com/restaurant",
    website: "https://www.medici57.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2974.7185005059973!2d-87.5963318231074!3d41.79127997084446!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880e2913f4218113%3A0xb7f1686638eae451!2sMedici%20On%2057th!5e0!3m2!1sen!2sus!4v1713586042913!5m2!1sen!2sus",
    src1: "./restuarant_pics/Medici.jpg",
    src2: "./restuarant_pics/Medici.jpg"
  },
  {
    title: "Monteverde Restaurant & Pastificio",
    address: "1020 W Madison St, Chicago, IL 60607",
    phone: "(312)-888-3041",
    hours: "11 AM - 9:30 PM",
    reviews: "4.7",
    preference: "Organic food",
    allergyFriendly: "Wheat, Shellfish",
    menu: "https://monteverdechicago.com/menu/",
    website: "https://monteverdechicago.com/",
    iframe1: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2970.512218725466!2d-87.6555443231044!3d41.8818400651788!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880e2cdbe18c5831%3A0x5d43ff6c1f096276!2sMonteverde%20Restaurant%20%26%20Pastificio!5e0!3m2!1sen!2sus!4v1713586248535!5m2!1sen!2sus",
    src1: "./restuarant_pics/Monteverde Restaurant & Pastificio.jpg",
    src2: "./restuarant_pics/Monteverde Restaurant & Pastificio.jpg"
  },
];

// Define arrays and variables for DOM elements
var favoriteRestaurants = [];
var x
const listBoxx = document.querySelector('.list-box');
const listDetaill = document.querySelector('.list-detail');
var listBox = document.getElementsByClassName('list-box');
var listDetail = document.getElementsByClassName('list-detail');
var favorite = document.getElementsByClassName('favorite')
var chartBox = document.getElementsByClassName('chartBox')
var detail = document.getElementsByClassName('list-detail')

// Loop through detailData to create list items for each restauran
detailData.forEach(data => {
  const listItem = document.createElement('div');
  listItem.classList.add('list');
  listItem.innerHTML = `
        <img src="${data.src1}" alt="">
        <div class="info">
            <div>Name: ${data.title}</div>
            <div>Address: ${data.address}</div>
            <div>Time: ${data.hours}</div>
            <div>Phone: ${data.phone}</div>
            <div>Allergy: ${data.allergyFriendly}</div>
            <div>Preference: ${data.preference}</div>
        </div>
    `;
  // listItem.addEventListener('dblclick', () => {
  //   updateDetailAndIframe(data);
  //   listDetail[0].style.display = "flex"
  //   listBox[0].style.display = "none"
  //   x = data;

  // });
  listItem.addEventListener('click', () => {
    updateDetailAndIframe(data);
    listDetail[0].style.display = "flex"
    listBox[0].style.display = "none"
    x = data;
  });
  listBoxx.appendChild(listItem);
});

// Update double click event handler to check if restaurant is already favorited
function updateDetailAndIframe(data) {
  const listDetail = document.querySelector('.list-detailxxx');
  const iframe = document.querySelector('.iframe-container iframe');
  const imgElement = document.getElementById('img');

  // Check if restaurant is favorited
  const isRestaurantFavorited = isRestaurantInFavorites(data);

  // Update favorite icon based on favorited status
  if (isRestaurantFavorited) {
    imgElement.src = './image/xin.png';
  } else {
    imgElement.src = './image/xin2.png';
  }

  // Update HTML content with data values
  listDetail.innerHTML = `
    <img src="${data.src2}" alt="">
    <div class="title">${data.title}</div>
    <div class="info">Phone: ${data.phone}</div>
    <div class="info">Hours: ${data.hours}</div>
    <div class="info">Reviews: ${data.reviews}</div>
    <div class="info">Preference: ${data.preference}</div>
    <div class="info">Allergy-Friendly: ${data.allergyFriendly}</div>
    <div class="info">Menu: <a href="${data.menu}" target="_blank">${data.menu}</a></div>
    <div class="info">Official website: <a href="${data.website}" target="_blank">${data.website}</a></div>
  `;

  // Update iframe src
  iframe.src = data.iframe1;

  // Show the list-detail element
  listDetail.style.display = 'block';
}

// Function to check if restaurant is in favorites list
function isRestaurantInFavorites(data) {
  const favoriteBox = document.getElementById('favorite-box');
  const restaurants = favoriteBox.querySelectorAll('.list-1');

  // Check if any favorited restaurant matches current restaurant
  for (let i = 0; i < restaurants.length; i++) {
    const restaurant = restaurants[i];
    const nameElement = restaurant.querySelector('.info div');
    if (nameElement.textContent.includes(data.title)) {
      return true;
    }
  }

  return false;
}

function updateIframe(data) {
  const iframe = document.querySelector('.iframe-container iframe');
  iframe.src = data.iframe1;
}

var imgElement = document.getElementById('img');


function shou() {
  const isRestaurantFavorited = isRestaurantInFavorites(x);
  if (!isRestaurantFavorited) {
    addToFavorites(x);
  } else {
    removeFromFavorites(x);
  }
}

// Function to handle adding restaurant to favorites
function addToFavorites(data) {
  const favoriteBox = document.getElementById('favorite-box');
  const html = `
    <div class="list-1">
      <img style="width: 100px; height: 100px;" src="${data.src1}" alt="">
      <div class="info">
        <div>Name: ${data.title}</div>
        <div>Address: ${data.address}</div>
        <div>Allergy: ${data.allergyFriendly}</div>
        <div>Preference: ${data.preference}</div>
      </div>
    </div>
  `;

  favoriteBox.innerHTML += html;
  favoriteRestaurants.push(data);
  updateFavoriteButtonImage(true);
}

// Function to remove restaurant from favorites
function removeFromFavorites(data) {
  const favoriteBox = document.getElementById('favorite-box');
  const restaurants = favoriteBox.querySelectorAll('.list-1');
  restaurants.forEach(restaurant => {
    const nameElement = restaurant.querySelector('.info div');
    if (nameElement.textContent.includes(data.title)) {
      restaurant.remove();
      const index = favoriteRestaurants.findIndex(item => item.title === data.title);
      if (index !== -1) {
        favoriteRestaurants.splice(index, 1);
      }
      updateFavoriteButtonImage(false);
    }
  });
}

// Function to update favorite button image
function updateFavoriteButtonImage(isFavorited) {
  const imgElement = document.getElementById('img');
  if (isFavorited) {
    imgElement.src = './image/xin.png';
  } else {
    imgElement.src = './image/xin2.png';
  }
}

// Function to show details of clicked favorite restaurant
function isRestaurantInFavorites(data) {
  const favoriteBox = document.getElementById('favorite-box');
  const restaurants = favoriteBox.querySelectorAll('.list-1');
  for (let i = 0; i < restaurants.length; i++) {
    const restaurant = restaurants[i];
    const nameElement = restaurant.querySelector('.info div');
    if (nameElement.textContent.includes(data.title)) {
      return true;
    }
  }
  return false;
}




const favoriteBox = document.getElementById('favorite-box');

// Add event listener to favorite items
favoriteBox.addEventListener('click', (event) => {
  const clickedItem = event.target.closest('.list-1');
  if (clickedItem) {
    const titleElement = clickedItem.querySelector('.info div:first-child');
    const restaurantTitle = titleElement.textContent.split(':')[1].trim();
    const restaurantData = favoriteRestaurants.find(restaurant => restaurant.title === restaurantTitle);
    if (restaurantData) {
      updateDetailAndIframe(restaurantData);
      updateIframe(restaurantData);
      listDetail[0].style.display = "flex";
      listBox[0].style.display = "none";
      favorite[0].style.display = "none";
      x = restaurantData;
    }
  }
});


function handleItemClick(item) {
  // Get all items in the list-detailxxx container
  var items = document.querySelectorAll('.list');

  // Loop through each item
  items.forEach(function (itemElement) {
    // Get the text content of the Preference and Allergy-Friendly elements
    var preference = itemElement.querySelector('.info:nth-child(5)').textContent;
    var allergyFriendly = itemElement.querySelector('.info:nth-child(6)').textContent;

    // Check if the item matches the preference or allergy-friendly category
    if (preference.includes(item) || allergyFriendly.includes(item)) {
      // Display the item if it matches
      itemElement.style.display = 'block';
    } else {
      // Hide the item if it doesn't match
      itemElement.style.display = 'none';
    }
  });
}


function handleItemClick(item) {
  // Filter detailData based on the clicked item
  const filteredData = detailData.filter(data => {
    return data.allergyFriendly === item || data.preference === item;
  });

  // Clear the current list box
  listBoxx.innerHTML = '';

  // Append filtered items to the list box
  filteredData.forEach(data => {
    const listItem = document.createElement('div');
    listItem.classList.add('list');
    listItem.innerHTML = `
          <img src="${data.src1}" alt="">
          <div class="info">
              <div>Name: ${data.title}</div>
              <div>Address: ${data.address}</div>
              <div>Time: ${data.hours}</div>
              <div>Phone: ${data.phone}</div>
              <div>Allergy: ${data.allergyFriendly}</div>
              <div>Preference: ${data.preference}</div>
          </div>
      `;
    listItem.addEventListener('dblclick', () => {
      updateDetailAndIframe(data);
      listDetail[0].style.display = "flex"
      listBox[0].style.display = "none"
      x = data;
    });
    listItem.addEventListener('click', () => {
      updateIframe(data);
    });
    listBoxx.appendChild(listItem);
  });
}



function favoriteShow() {
  listBox[0].style.display = "none"
  favorite[0].style.display = "flex"
  detail[0].style.display = "none"
  chartBox[0].style.display = "none"
}

function AllergyFun() {
  listBox[0].style.display = "flex"
  favorite[0].style.display = "none"
  detail[0].style.display = "none"
  chartBox[0].style.display = "none"
  imgElement.src = './image/xin2.png'
}

function GroupFun() {
  listBox[0].style.display = "none"
  favorite[0].style.display = "none"
  detail[0].style.display = "none"
  chartBox[0].style.display = "flex"
}

document.addEventListener('keydown', function (event) {
  if (event.key === "Escape") {
    detail[0].style.display = "none"
    listBox[0].style.display = "flex"
    chartBox[0].style.display = "none"
    favorite[0].style.display = "none"
    var items = document.querySelectorAll('.list');
    items.forEach(function (itemElement) {
      itemElement.style.display = 'flex';
    }
    );
  }
  if (event.key === "Enter") {
    handleInput();
  }
});

function handleItemClick(item) {
  var items = document.querySelectorAll('.list');
  items.forEach(function (itemElement) {
    var allergyFriendly = itemElement.querySelector('.info div:nth-child(5)').textContent;
    var preference = itemElement.querySelector('.info div:nth-child(6)').textContent;
    if (preference.includes(item) || allergyFriendly.includes(item)) {
      itemElement.style.display = 'flex';
    }
    else {
      itemElement.style.display = 'none';
    }
  });
}



function handleInput() {
  var item = document.getElementById('userInput');
  var user = item.value;
  var items = document.querySelectorAll('.list');
  items.forEach(function (itemElement) {
    var restaurant = itemElement.querySelector('.info div:nth-child(1)').textContent;
    var allergyFriendly = itemElement.querySelector('.info div:nth-child(5)').textContent;
    var preference = itemElement.querySelector('.info div:nth-child(6)').textContent;
    if (preference.includes(user) || allergyFriendly.includes(user) || restaurant.includes(user)) {
      itemElement.style.display = 'flex';
    }
    else {
      itemElement.style.display = 'none';
    }
  });
}




// Function to create a menu item
function createMenuItem1(name) {
  let li = document.createElement('div');
  li.className = "list-in"
  li.innerHTML = name;
  return li;
}

// Function to handle enter key press
function handleEnter(event, inputElement) {
  console.log();
  if (event.key === 'Enter') {
    event.preventDefault();
    var chart = document.getElementById('chart')
    var html = '<div class="content">' + document.getElementById('myInput').value + '</div>' +
      '<img src="./image/2.jpg" alt="">';
    chart.appendChild(createMenuItem1(html))
  }
}